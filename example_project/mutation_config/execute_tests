#!/bin/bash

# A simple example on how to set up an "execute_tests" hook

# Go to the example project root directory
# (You probably shouldn't use a relative path in a real project though)
cd ..

# Build tests
make

# Run tests
target/test

# Only move the test results if execution ended normally (i.e. no SEGFAULT etc)
#
# NOTE: CMTT will interpret missing results as an abnormal termination of the
# test execution (this is not considered as a live mutant, since it is "caught").
#
if [ $? == 0 ]; then
    # Move the test output to "test_results" in the root of the mutation_output folder
    # (which is where CMTT expects to find it after calling this test hook).
    #
    # NOTE: In a real project, this file could instead for example be concatenated from
    #       multiple result file(s) generated by a test framework.
    #
    #       Time stamps and other such "moving parts" must be stripped from the file,
    #       otherwise two tests executions will always seem to differ when compared!
    #
    mv target/test_results mutation_output/
fi
